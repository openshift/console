import {
  getVulnerabilitySource,
  getVulnerabilityType,
  VulnerabilitiesType,
} from '../image-vulnerability-utils';
import { vulnerabilities } from './vulnerability-test-data';

describe('image-vulnerability-utils', () => {
  it('getVulnerabilityType should return VulnerabilitiesType appDependency', () => {
    const vulnerabilityType = getVulnerabilityType(vulnerabilities[3]);
    expect(vulnerabilityType).toBe(VulnerabilitiesType.appDependency);
  });

  it('getVulnerabilityType should return VulnerabilitiesType baseImage', () => {
    const vulnerabilityType = getVulnerabilityType(vulnerabilities[0]);
    expect(vulnerabilityType).toBe(VulnerabilitiesType.baseImage);
  });

  it('getVulnerabilitySource should return Red Hat', () => {
    const vulnerabilityType = getVulnerabilitySource(vulnerabilities[0]);
    expect(vulnerabilityType).toBe('Red Hat');
  });

  it('getVulnerabilitySource should return Snyk', () => {
    const vulnerabilityType = getVulnerabilitySource(vulnerabilities[3]);
    expect(vulnerabilityType).toBe('Snyk');
  });
});
